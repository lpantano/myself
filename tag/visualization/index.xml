<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Visualization | My bits</title>
    <link>http://lpantano.github.io/tag/visualization/</link>
      <atom:link href="http://lpantano.github.io/tag/visualization/index.xml" rel="self" type="application/rss+xml" />
    <description>Visualization</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>en-us</language><lastBuildDate>Fri, 16 Jan 2026 12:00:00 -0400</lastBuildDate>
    <image>
      <url>http://lpantano.github.io/media/icon_hu_518ecd45d9711c5b.png</url>
      <title>Visualization</title>
      <link>http://lpantano.github.io/tag/visualization/</link>
    </image>
    
    <item>
      <title>Bringing IGV webapp to Your Cloud Workspace in Seqera</title>
      <link>http://lpantano.github.io/post/2026/2026-01-16-igv-cloud-visualization/</link>
      <pubDate>Fri, 16 Jan 2026 12:00:00 -0400</pubDate>
      <guid>http://lpantano.github.io/post/2026/2026-01-16-igv-cloud-visualization/</guid>
      <description>&lt;p&gt;You just ran a genomic pipeline that generated 50GB of BAM files in the cloud. Now you need to check alignment quality. Do you really have to download everything to run IGV locally? Switch virtual machines to load the files? Write code to generate static visuals?&lt;/p&gt;
&lt;p&gt;This integration brings IGV directly to your cloud workspace with &lt;strong&gt;automatic track discovery&lt;/strong&gt;. It scans your storage, finds all genomic files, and presents them in a ready-to-load menu. No downloads, no file paths, no manual configuration.&lt;/p&gt;
&lt;h2 id=&#34;the-workflow-gap&#34;&gt;The Workflow Gap&lt;/h2&gt;
&lt;p&gt;Analysis happens in the cloud. Fast compute, scalable storage, pipelines that finish overnight.&lt;/p&gt;
&lt;p&gt;Visualization happens separately or requires coding. Manual downloads or transfers, disk space constraints, waiting for transfers to complete, changing environments.&lt;/p&gt;
&lt;p&gt;This gap slows iteration. It wastes time. And it&amp;rsquo;s fixable.&lt;/p&gt;
&lt;h2 id=&#34;what-cloud-native-visualization-looks-like&#34;&gt;What Cloud-Native Visualization Looks Like&lt;/h2&gt;
&lt;p&gt;I built an integration that runs IGV as a web app directly in Seqera workspaces. It connects to the same cloud storage your pipelines write to. It automatically discovers all genomic files. Zero downloads, zero manual file loading.&lt;/p&gt;
&lt;p&gt;Other solutions exist—desktop IGV in Studios or Python notebooks for programmatic visualization. These work, but they&amp;rsquo;re not seamless. Desktop IGV still requires manual file path configuration. Notebooks require coding for every view. This approach eliminates both friction points.&lt;/p&gt;
&lt;h2 id=&#34;how-it-works&#34;&gt;How It Works&lt;/h2&gt;
&lt;p&gt;The container combines IGV web app with Seqera&amp;rsquo;s connect-client. The connect-client uses FUSE to mount cloud storage, making remote files appear local to IGV.&lt;/p&gt;
&lt;p&gt;A startup script &lt;strong&gt;scans&lt;/strong&gt; mounted directories for genomic files—BAM, CRAM, VCF, BED, BigWig, anything IGV can read. It detects file formats, checks for index files, and generates a track catalog. IGV reads this catalog and populates a custom &amp;ldquo;Auto-discovered Tracks&amp;rdquo; menu.&lt;/p&gt;
&lt;p&gt;The visualization tool comes to where data already lives.&lt;/p&gt;
&lt;h2 id=&#34;what-this-looks-like-in-practice&#34;&gt;What This Looks Like in Practice&lt;/h2&gt;
&lt;p&gt;Launch the IGV Studio from your Seqera interface. Your browser opens with the IGV web app.&lt;/p&gt;
&lt;p&gt;Click Tracks → Auto-discovered Tracks. See a table of all your BAM files, VCF variants, coverage tracks—everything in your mounted storage.&lt;/p&gt;
&lt;p&gt;Click to load. Instant visualization.&lt;/p&gt;
&lt;h2 id=&#34;why-this-matters&#34;&gt;Why This Matters&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Skip the download/coding wait.&lt;/strong&gt; Checking alignments after a pipeline run no longer means waiting to transfer data or coding.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Stop duplicating storage.&lt;/strong&gt; No local copies means hundreds of GB saved per researcher.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Share results faster.&lt;/strong&gt; Send a browser URL instead of transferring massive files.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Onboard easier.&lt;/strong&gt; New team members don&amp;rsquo;t need complex local setups. They click a link and start viewing data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Improve reproducibility.&lt;/strong&gt; Everyone views the same authoritative data source in cloud storage, not their own potentially outdated local copies.&lt;/p&gt;
&lt;h2 id=&#34;getting-started&#34;&gt;Getting Started&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Important context:&lt;/strong&gt; This solution is specifically for Seqera Platform users. If you&amp;rsquo;re using other platforms like Terra, AnVIL, Galaxy, or DNAnexus, they have their own approaches to interactive visualization. This implementation leverages Seqera&amp;rsquo;s Studios feature and connect-client architecture.&lt;/p&gt;
&lt;p&gt;The full implementation is open source in the &lt;a href=&#34;https://github.com/lpantano/custom-studios-examples/tree/master/igv&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Seqera custom studios examples repository&lt;/a&gt;. You&amp;rsquo;ll find:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Complete Dockerfile with multi-stage build&lt;/li&gt;
&lt;li&gt;Automatic track discovery script&lt;/li&gt;
&lt;li&gt;Deployment documentation&lt;/li&gt;
&lt;li&gt;Configuration examples&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Maturity note:&lt;/strong&gt; This is a proof of concept tested on several datasets. It demonstrates the pattern and should help you get started, but expect to adapt it for production use. Test thoroughly with your own data and file structures.&lt;/p&gt;
&lt;p&gt;The code is customizable. Adapt the track discovery logic for your file naming conventions. Change the reference genome. Add authentication if needed.&lt;/p&gt;
&lt;h2 id=&#34;the-broader-pattern&#34;&gt;The Broader Pattern&lt;/h2&gt;
&lt;p&gt;Cloud-native analysis means rethinking entire workflows, not just moving compute. Bringing visualization to cloud data is part of that shift.&lt;/p&gt;
&lt;p&gt;Other platforms (Terra, AnVIL) mount cloud storage for interactive apps too. What makes this useful is the &lt;strong&gt;automatic track discovery&lt;/strong&gt;—most solutions require manual file paths.&lt;/p&gt;
&lt;p&gt;The less time you spend moving data around, the more time you spend understanding it.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;References:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Robinson JT, et al. (2011). Integrative genomics viewer. Nature Biotechnology 29(1):24-26. &lt;a href=&#34;https://www.nature.com/articles/nbt.1754&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DOI: 10.1038/nbt.1754&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://igv.org/doc/webapp/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IGV Web App Documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.seqera.io/platform-cloud/studios/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Seqera Studios Documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/lpantano/custom-studios-examples/tree/master/igv&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Implementation Repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Single-Cell RNA-Seq Analysis Reports</title>
      <link>http://lpantano.github.io/portfolio/singlecell-reports/</link>
      <pubDate>Tue, 13 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://lpantano.github.io/portfolio/singlecell-reports/</guid>
      <description>&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;A collection of code templates and training materials for performing downstream analysis following single-cell RNA preprocessing. This repository provides standardized workflows for researchers working with scRNA-seq data, from quality assessment to differential expression.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://bcbio.github.io/singlecell-reports/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;View Documentation →&lt;/strong&gt;&lt;/a&gt; | &lt;a href=&#34;https://github.com/bcbio/singlecell-reports&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;GitHub Repository →&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;key-features&#34;&gt;Key Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Quality Assessment&lt;/strong&gt;: Templates for evaluating scRNA and scATAC data quality&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Integration Analysis&lt;/strong&gt;: Workflows for combining multiple samples with batch effect correction&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Differential Expression&lt;/strong&gt;: Multiple approaches including pseudobulk analysis via DESeq2 and MAST methodology&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Compositional Analysis&lt;/strong&gt;: Methods for examining cell-type abundance changes across conditions&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Gene Imputation&lt;/strong&gt;: Techniques using ALRA and MAGIC algorithms to address data sparsity&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Pipeline Integration&lt;/strong&gt;: Support for nf-core scrnaseq pipeline outputs and standalone Cell Ranger processing&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;technical-stack&#34;&gt;Technical Stack&lt;/h2&gt;
&lt;p&gt;Built primarily in R with supporting shell scripts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Seurat for single-cell data handling and analysis&lt;/li&gt;
&lt;li&gt;DESeq2 for differential expression analysis&lt;/li&gt;
&lt;li&gt;Harmony for batch effect correction&lt;/li&gt;
&lt;li&gt;nf-core scrnaseq pipeline integration&lt;/li&gt;
&lt;li&gt;Quarto and R Markdown for reproducible reports&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;what-it-provides&#34;&gt;What It Provides&lt;/h2&gt;
&lt;p&gt;The repository includes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ready-to-use analysis templates for common scRNA-seq tasks&lt;/li&gt;
&lt;li&gt;Training materials and documentation&lt;/li&gt;
&lt;li&gt;Standardized workflows following best practices&lt;/li&gt;
&lt;li&gt;Integration with popular preprocessing pipelines&lt;/li&gt;
&lt;li&gt;Examples for both scRNA-seq and scATAC-seq data&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;development-status&#34;&gt;Development Status&lt;/h2&gt;
&lt;p&gt;Templates are labeled with revision tiers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Stable&lt;/strong&gt;: Fully tested and production-ready&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Alpha&lt;/strong&gt;: Functional but requires additional testing&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Draft&lt;/strong&gt;: Under active development, may need manual parameter tuning&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;why-this-matters&#34;&gt;Why This Matters&lt;/h2&gt;
&lt;p&gt;Single-cell RNA-seq analysis requires specialized knowledge and tools. This project:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reduces the learning curve for new single-cell researchers&lt;/li&gt;
&lt;li&gt;Provides validated workflows following community best practices&lt;/li&gt;
&lt;li&gt;Enables reproducible analysis through standardized templates&lt;/li&gt;
&lt;li&gt;Supports multiple experimental designs and research questions&lt;/li&gt;
&lt;li&gt;Integrates seamlessly with popular preprocessing pipelines&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For more information or to contribute, visit the &lt;a href=&#34;https://github.com/bcbio/singlecell-reports&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub repository&lt;/a&gt; or explore the &lt;a href=&#34;https://bcbio.github.io/singlecell-reports/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;documentation&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Spatial Transcriptomics Analysis Reports</title>
      <link>http://lpantano.github.io/portfolio/spatial-reports/</link>
      <pubDate>Tue, 13 Jan 2026 00:00:00 +0000</pubDate>
      <guid>http://lpantano.github.io/portfolio/spatial-reports/</guid>
      <description>&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;A template repository providing analysis workflows for spatial single-cell transcriptomics data across multiple experimental platforms and analytical packages. This project offers researchers standardized pipelines for quality control, clustering, and cell-type annotation.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/bcbio/spatial-reports&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;View on GitHub →&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;key-features&#34;&gt;Key Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Multi-Platform Support&lt;/strong&gt;: Templates for COSMX and Visium[HD] spatial transcriptomics platforms&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Quality Control Pipelines&lt;/strong&gt;: Comprehensive QC assessment workflows for data validation&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Clustering Workflows&lt;/strong&gt;: Spatial clustering using Banksy and other established tools&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cell-Type Annotation&lt;/strong&gt;: Integration with spacexr for cell-type identification and differential expression&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Reproducible Environment&lt;/strong&gt;: RStudio Projects with renv package management for dependency control&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;technical-stack&#34;&gt;Technical Stack&lt;/h2&gt;
&lt;p&gt;Built entirely in R with integration of leading bioinformatics tools:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Seurat for Visium object handling&lt;/li&gt;
&lt;li&gt;Banksy for spatial clustering analysis&lt;/li&gt;
&lt;li&gt;spacexr for cell-type identification&lt;/li&gt;
&lt;li&gt;Quarto and R Markdown for report generation&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;what-it-provides&#34;&gt;What It Provides&lt;/h2&gt;
&lt;p&gt;The repository includes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ready-to-use analysis templates&lt;/li&gt;
&lt;li&gt;Downloadable test data for learning and validation&lt;/li&gt;
&lt;li&gt;Dependency installation scripts&lt;/li&gt;
&lt;li&gt;Quick-start documentation for RStudio users&lt;/li&gt;
&lt;li&gt;Standardized workflows across different spatial platforms&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;development-status&#34;&gt;Development Status&lt;/h2&gt;
&lt;p&gt;Projects are labeled with revision tiers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Stable&lt;/strong&gt;: Fully tested and production-ready&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Alpha&lt;/strong&gt;: Functional but requires additional testing&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Draft&lt;/strong&gt;: Under active development, may need manual parameter tuning&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;why-this-matters&#34;&gt;Why This Matters&lt;/h2&gt;
&lt;p&gt;Spatial transcriptomics generates complex data requiring specialized analysis approaches. This project:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reduces setup time for new spatial transcriptomics projects&lt;/li&gt;
&lt;li&gt;Provides validated workflows following best practices&lt;/li&gt;
&lt;li&gt;Enables reproducible research through standardized templates&lt;/li&gt;
&lt;li&gt;Lowers the barrier to entry for spatial data analysis&lt;/li&gt;
&lt;li&gt;Maintains consistency across different experimental platforms&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For more information or to contribute, visit the &lt;a href=&#34;https://github.com/bcbio/spatial-reports&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub repository&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Training Progress Dashboard</title>
      <link>http://lpantano.github.io/portfolio/training-dashboard/</link>
      <pubDate>Sun, 10 Nov 2024 00:00:00 +0000</pubDate>
      <guid>http://lpantano.github.io/portfolio/training-dashboard/</guid>
      <description>&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;An interactive dashboard built with React.js that visualizes personal training data from Apple Health and Garmin Connect apps. This project demonstrates data visualization best practices and the importance of personal data ownership.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://run-training-activities.netlify.app&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;strong&gt;View Live Dashboard →&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;key-features&#34;&gt;Key Features&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Multi-source Data Integration&lt;/strong&gt;: Combines data from Apple Health and Garmin Connect&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Interactive Visualizations&lt;/strong&gt;: Track adaptations in speed, distance, time, and heart rate over time&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Responsive Design&lt;/strong&gt;: Built with React.js for a smooth user experience&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data Ownership Focus&lt;/strong&gt;: Demonstrates how individuals can take control of their health data&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;technical-approach&#34;&gt;Technical Approach&lt;/h2&gt;
&lt;p&gt;This dashboard emphasizes the importance of:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Personal data ownership and management&lt;/li&gt;
&lt;li&gt;Standardized data export formats&lt;/li&gt;
&lt;li&gt;Independent data analysis capabilities&lt;/li&gt;
&lt;li&gt;User empowerment over corporate data silos&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;what-it-shows&#34;&gt;What It Shows&lt;/h2&gt;
&lt;p&gt;The dashboard tracks my personal training progress, revealing patterns in:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Speed improvements over time&lt;/li&gt;
&lt;li&gt;Distance progression&lt;/li&gt;
&lt;li&gt;Heart rate adaptation&lt;/li&gt;
&lt;li&gt;Training consistency&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Future enhancements will correlate this data with broader health insights to provide a more comprehensive view of fitness and well-being.&lt;/p&gt;
&lt;h2 id=&#34;why-this-matters&#34;&gt;Why This Matters&lt;/h2&gt;
&lt;p&gt;Too often, our personal health data is locked in proprietary apps or leveraged by large corporations. This project advocates for:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Apps offering data export in standardized formats&lt;/li&gt;
&lt;li&gt;Individual control over personal data&lt;/li&gt;
&lt;li&gt;Informed decision-making through accessible analytics&lt;/li&gt;
&lt;li&gt;Independence from vendor lock-in&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For more information or to discuss similar visualization projects, feel free to reach out.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Get colors for your heatmap annotation</title>
      <link>http://lpantano.github.io/post/legacy/2018-09-21-colors-for-annotations-for-heatmaps/</link>
      <pubDate>Fri, 21 Sep 2018 10:13:02 -0400</pubDate>
      <guid>http://lpantano.github.io/post/legacy/2018-09-21-colors-for-annotations-for-heatmaps/</guid>
      <description>&lt;p&gt;This post will show how to configure quickly the colors for the annotation of rows/columns that go on top or on the side of a heatmap.&lt;/p&gt;
&lt;p&gt;I normally use &lt;code&gt;pheatmap&lt;/code&gt; a lot. Recently I discovered &lt;code&gt;ComplexHeatmap&lt;/code&gt;. In both cases I spend always sometime changing the colors of the annotations. I ended up coding a function inside my package &lt;code&gt;DEGreport&lt;/code&gt; to do that.&lt;/p&gt;
&lt;p&gt;Given a data.frame with metadata data information will do:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;white-black scale for numerical variables&lt;/li&gt;
&lt;li&gt;blue-orange for categorical values with only two categories&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Set2&lt;/code&gt; palette for categorical values with more than two categories&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All three color sets can be changed using the &lt;a href=&#34;http://lpantano.github.io/DEGreport/reference/degColors.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;parameters function&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(DEGreport)
library(stemHypoxia)
data(stemHypoxia)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I am going to use this &lt;a href=&#34;https://bioconductor.org/packages/release/data/experiment/html/stemHypoxia.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;stemcell experiment dataset&lt;/a&gt; I found randomly in Bioconductor page.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;exp = as.matrix(M[,3:30])
rownames(exp) = M[,2]
rownames(design) = colnames(exp)
design = design[,c(1:2)]
design$time = as.factor(design$time)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I&amp;rsquo;ll find the most variable genes.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;most_variable = names(tail(sort(apply(exp, 1, sd)), 1000))
design$mean_gene = colMeans(exp[most_variable,])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And we can plot the heatmap with new colors with need to specify each variable at a time.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(pheatmap)
pheatmap(exp[most_variable,], scale = &amp;quot;row&amp;quot;, show_rownames = FALSE,
         annotation_col = design,
         annotation_colors = degColors(design))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://github.com/lpantano/mypubs/raw/master/code-blog/degcolor/degcolors_files/figure-markdown_github/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;If you use &lt;code&gt;ComplexHeatmap&lt;/code&gt; you can activate &lt;code&gt;col_fun = TRUE&lt;/code&gt; to get it working.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;R Session&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::session_info()
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: &#39;DESCRIPTION&#39; file has an &#39;Encoding&#39; field and re-encoding is not
## possible

## Session info -------------------------------------------------------------

##  setting  value
##  version  R version 3.5.1 (2018-07-02)
##  system   x86_64, darwin15.6.0
##  ui       X11
##  language (EN)
##  collate  en_US.UTF-8
##  tz       America/New_York
##  date     2018-09-21

## Packages -----------------------------------------------------------------

##  package              * version   date       source
##  acepack                1.4.1     2016-10-29 cran (@1.4.1)
##  annotate               1.58.0    2018-05-01 cran (@1.58.0)
##  AnnotationDbi          1.42.1    2018-05-08 Bioconductor
##  assertthat             0.2.0     2017-04-11 CRAN (R 3.5.0)
##  backports              1.1.2     2017-12-13 CRAN (R 3.5.0)
##  base                 * 3.5.1     2018-07-05 local
##  base64enc              0.1-3     2015-07-28 CRAN (R 3.5.0)
##  bindr                  0.1.1     2018-03-13 CRAN (R 3.5.0)
##  bindrcpp               0.2.2     2018-03-29 CRAN (R 3.5.0)
##  Biobase                2.40.0    2018-05-01 Bioconductor
##  BiocGenerics           0.26.0    2018-05-01 Bioconductor
##  BiocParallel           1.14.2    2018-07-08 cran (@1.14.2)
##  bit                    1.1-14    2018-05-29 CRAN (R 3.5.0)
##  bit64                  0.9-7     2017-05-08 CRAN (R 3.5.0)
##  bitops                 1.0-6     2013-08-17 cran (@1.0-6)
##  blob                   1.1.1     2018-03-25 CRAN (R 3.5.0)
##  broom                  0.5.0     2018-07-17 CRAN (R 3.5.0)
##  checkmate              1.8.5     2017-10-24 cran (@1.8.5)
##  circlize               0.4.4     2018-06-10 cran (@0.4.4)
##  cluster                2.0.7-1   2018-04-13 CRAN (R 3.5.1)
##  colorspace             1.3-2     2016-12-14 CRAN (R 3.5.0)
##  compiler               3.5.1     2018-07-05 local
##  ComplexHeatmap         1.18.1    2018-06-19 cran (@1.18.1)
##  ConsensusClusterPlus   1.44.0    2018-05-01 cran (@1.44.0)
##  cowplot                0.9.3     2018-07-15 cran (@0.9.3)
##  crayon                 1.3.4     2017-09-16 CRAN (R 3.5.0)
##  data.table             1.11.4    2018-05-27 cran (@1.11.4)
##  datasets             * 3.5.1     2018-07-05 local
##  DBI                    1.0.0     2018-05-02 CRAN (R 3.5.0)
##  DEGreport            * 1.17.5    2018-09-04 local (lpantano/DEGreport@NA)
##  DelayedArray           0.6.5     2018-08-15 cran (@0.6.5)
##  DESeq2                 1.20.0    2018-05-01 Bioconductor
##  devtools               1.13.6    2018-06-27 CRAN (R 3.5.0)
##  digest                 0.6.16    2018-08-22 CRAN (R 3.5.0)
##  dplyr                  0.7.6     2018-06-29 CRAN (R 3.5.1)
##  edgeR                  3.22.3    2018-06-21 cran (@3.22.3)
##  evaluate               0.11      2018-07-17 CRAN (R 3.5.0)
##  foreign                0.8-71    2018-07-20 CRAN (R 3.5.0)
##  Formula                1.2-3     2018-05-03 cran (@1.2-3)
##  genefilter             1.62.0    2018-05-01 cran (@1.62.0)
##  geneplotter            1.58.0    2018-05-01 cran (@1.58.0)
##  GenomeInfoDb           1.16.0    2018-05-01 cran (@1.16.0)
##  GenomeInfoDbData       1.1.0     2018-08-31 Bioconductor
##  GenomicRanges          1.32.6    2018-07-20 cran (@1.32.6)
##  GetoptLong             0.1.7     2018-06-10 cran (@0.1.7)
##  ggdendro               0.1-20    2016-04-27 cran (@0.1-20)
##  ggplot2                3.0.0     2018-07-03 CRAN (R 3.5.0)
##  ggrepel                0.8.0     2018-05-09 cran (@0.8.0)
##  GlobalOptions          0.1.0     2018-06-09 cran (@0.1.0)
##  glue                   1.3.0     2018-07-17 CRAN (R 3.5.0)
##  graphics             * 3.5.1     2018-07-05 local
##  grDevices            * 3.5.1     2018-07-05 local
##  grid                   3.5.1     2018-07-05 local
##  gridExtra              2.3       2017-09-09 cran (@2.3)
##  gtable                 0.2.0     2016-02-26 CRAN (R 3.5.0)
##  Hmisc                  4.1-1     2018-01-03 cran (@4.1-1)
##  htmlTable              1.12      2018-05-26 cran (@1.12)
##  htmltools              0.3.6     2017-04-28 CRAN (R 3.5.0)
##  htmlwidgets            1.2       2018-04-19 cran (@1.2)
##  IRanges                2.14.11   2018-08-24 Bioconductor
##  knitr                  1.20      2018-02-20 CRAN (R 3.5.0)
##  lasso2                 1.2-19    2014-05-31 cran (@1.2-19)
##  lattice                0.20-35   2017-03-25 CRAN (R 3.5.1)
##  latticeExtra           0.6-28    2016-02-09 cran (@0.6-28)
##  lazyeval               0.2.1     2017-10-29 CRAN (R 3.5.0)
##  limma                  3.36.3    2018-08-25 cran (@3.36.3)
##  locfit                 1.5-9.1   2013-04-20 cran (@1.5-9.1)
##  logging                0.7-103   2013-04-12 cran (@0.7-103)
##  magrittr               1.5       2014-11-22 CRAN (R 3.5.0)
##  MASS                   7.3-50    2018-04-30 CRAN (R 3.5.1)
##  Matrix                 1.2-14    2018-04-13 CRAN (R 3.5.1)
##  matrixStats            0.54.0    2018-07-23 cran (@0.54.0)
##  memoise                1.1.0     2017-04-21 CRAN (R 3.5.0)
##  methods              * 3.5.1     2018-07-05 local
##  mnormt                 1.5-5     2016-10-15 cran (@1.5-5)
##  munsell                0.5.0     2018-06-12 CRAN (R 3.5.0)
##  nlme                   3.1-137   2018-04-07 CRAN (R 3.5.1)
##  nnet                   7.3-12    2016-02-02 CRAN (R 3.5.1)
##  Nozzle.R1              1.1-1     2013-05-15 cran (@1.1-1)
##  parallel               3.5.1     2018-07-05 local
##  pheatmap             * 1.0.10    2018-05-19 CRAN (R 3.5.0)
##  pillar                 1.3.0     2018-07-14 CRAN (R 3.5.0)
##  pkgconfig              2.0.2     2018-08-16 CRAN (R 3.5.0)
##  plyr                   1.8.4     2016-06-08 CRAN (R 3.5.0)
##  psych                  1.8.4     2018-05-06 cran (@1.8.4)
##  purrr                  0.2.5     2018-05-29 CRAN (R 3.5.0)
##  R6                     2.2.2     2017-06-17 CRAN (R 3.5.0)
##  RColorBrewer           1.1-2     2014-12-07 CRAN (R 3.5.0)
##  Rcpp                   0.12.18   2018-07-23 CRAN (R 3.5.0)
##  RCurl                  1.95-4.11 2018-07-15 cran (@1.95-4.)
##  reshape                0.8.7     2017-08-06 cran (@0.8.7)
##  rjson                  0.2.20    2018-06-08 cran (@0.2.20)
##  rlang                  0.2.2     2018-08-16 CRAN (R 3.5.0)
##  rmarkdown              1.10      2018-06-11 CRAN (R 3.5.0)
##  rpart                  4.1-13    2018-02-23 CRAN (R 3.5.1)
##  rprojroot              1.3-2     2018-01-03 CRAN (R 3.5.0)
##  RSQLite                2.1.1     2018-05-06 CRAN (R 3.5.0)
##  rstudioapi             0.7       2017-09-07 CRAN (R 3.5.0)
##  S4Vectors              0.18.3    2018-06-08 Bioconductor
##  scales                 1.0.0     2018-08-09 CRAN (R 3.5.0)
##  shape                  1.4.4     2018-02-07 cran (@1.4.4)
##  splines                3.5.1     2018-07-05 local
##  stats                * 3.5.1     2018-07-05 local
##  stats4                 3.5.1     2018-07-05 local
##  stemHypoxia          * 1.16.0    2018-09-21 Bioconductor
##  stringi                1.2.4     2018-07-20 CRAN (R 3.5.0)
##  stringr                1.3.1     2018-05-10 CRAN (R 3.5.0)
##  SummarizedExperiment   1.10.1    2018-05-11 Bioconductor
##  survival               2.42-6    2018-07-13 CRAN (R 3.5.0)
##  tibble                 1.4.2     2018-01-22 CRAN (R 3.5.0)
##  tidyr                  0.8.1     2018-05-18 CRAN (R 3.5.0)
##  tidyselect             0.2.4     2018-02-26 CRAN (R 3.5.0)
##  tools                  3.5.1     2018-07-05 local
##  utils                * 3.5.1     2018-07-05 local
##  withr                  2.1.2     2018-03-15 CRAN (R 3.5.0)
##  XML                    3.98-1.16 2018-08-19 cran (@3.98-1.)
##  xtable                 1.8-3     2018-08-29 cran (@1.8-3)
##  XVector                0.20.0    2018-05-01 cran (@0.20.0)
##  yaml                   2.2.0     2018-07-25 CRAN (R 3.5.0)
##  zlibbioc               1.26.0    2018-05-01 cran (@1.26.0)
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>
